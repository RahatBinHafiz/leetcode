class Solution {
public:
    #define ll long long int
    int minOperations(vector<int>& v) {
        int n = v.size();
        unordered_map<int, vector<int>> mp;


        for (int i = 0; i < n; i++)
            mp[v[i]].push_back(i);

        vector<int> keys;
        keys.reserve(mp.size());
        for (auto &p : mp) keys.push_back(p.first);
        sort(keys.begin(), keys.end());

        set<int> st;
        ll ans = 0;
        bool first = true;

        if (mp.count(0)) {
            for (int idx : mp[0]) st.insert(idx);
            mp.erase(0);
            first = false;
        }

        ans = mp.size();
        int cnt = 0;

        for (int key : keys) {
            if (!mp.count(key)) continue;
            auto &vec = mp[key];
            for (int j = 0; j < (int)vec.size(); j++) {
                if (first && cnt == 0) {
                    st.insert(vec[j]);
                } else {
                    auto it = st.lower_bound(vec[j]);
                    if (j + 1 < (int)vec.size() && it != st.end() && *it < vec[j + 1])
                        ans++;
                }
                st.insert(vec[j]);
            }
            cnt++;
        }

        return ans;
    }
};

