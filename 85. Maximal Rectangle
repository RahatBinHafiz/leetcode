class Solution {
public:
    int maximalRectangle(vector<vector<char>>& a) {
        int r = a.size(), c = a[0].size();
        vector<vector<int>> ps(r+1, vector<int>(c+1, 0));

        for(int i = 1; i <= r; i++)
            for(int j = 1; j <= c; j++)
                ps[i][j] = (a[i-1][j-1] == '1')
                           + ps[i-1][j] + ps[i][j-1] - ps[i-1][j-1];

        int ans = 0;

        for(int top = 1; top <= r; top++)
        {
            for(int bottom = top; bottom <= r; bottom++)
            {
                int width = 0;
                for(int col = 1; col <= c; col++)
                {
                    int ones = ps[bottom][col]
                             - ps[top-1][col]
                             - ps[bottom][col-1]
                             + ps[top-1][col-1];

                    if(ones == bottom - top + 1)
                    {
                        width++;
                        ans = max(ans, width * (bottom - top + 1));
                    }
                    else width = 0;
                }
            }
        }
        return ans;
    }
};
